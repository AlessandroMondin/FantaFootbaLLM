{
    "question": "how many goals has chukwueze scored this year?",
    "query": [
        {"$match": {"season": "2023-24", "matches.players.name": "chukwueze"}},
        {"$unwind": "$matches"},
        {"$unwind": "$matches.players"},
        {"$match": {"matches.players.name": "chukwueze"}},
        {"$group": {
            "_id": "$matches.players.name",
            "total_goals": {
                "$sum": {
                    "$reduce": {
                        "input": "$matches.players.bonus_malus",
                        "initialValue": 0,
                        "in": {
                            "$cond": [
                                {"$eq": ["$$this.title", "Gol segnati"]},
                                {"$add": ["$$value", "$$this.value"]},
                                "$$value"
                            ]
                        }
                    }
                }
            }
        }}
    ]
  }
  